import{f as C,i as _,k as M,m,J as S,d as O,o as U,c as E,a as t,t as o,x as $}from"./index-h2x63-Jx.js";const ot=()=>{const{airportNameMap:n,fetchAirports:v}=C(),{getTokenAndUserId:h}=_();M(()=>{v()});const d=m(!1),s=m(null),c=m(!1),f=m([]);return{checkIn:async(e,i)=>{d.value=!0,s.value=null,c.value=!1;try{if(!h().token)throw new Error("User not logged in");await S(`/checkin/${e}`,"POST",i,!0),c.value=!0}catch(r){throw s.value=r.message||"Check-in failed",r}finally{d.value=!1}},generateTicketData:(e,i,r,a)=>{const l=n.value,u=a.route.departureAirportCode||a.route.departureAirport_id||"???",x=a.route.arrivalAirportCode||a.route.arrivalAirport_id||"???",B=l[u]||"Unknown",I=l[x]||"Unknown";return{departureDate:new Date(e.departureDate).toLocaleDateString(),departureAirportName:B,arrivalAirportName:I,departureIATA:u,arrivalIATA:x,firstName:e.firstName,lastName:e.lastName,seatNumber:e.seatNumber||"N/A",flightNumber:a.flightNumber,flightStatus:a.status,departureTime:a.departureTime,qrDataUrl:r}},saveTicket:async(e,i,r)=>{const{getTokenAndUserId:a}=_(),l=a().userId,u={ticketId:r,ticketData:e,expirationDate:i,userId:l};try{await S(`/tickets/${r}`,"PUT",u,!0)}catch(x){console.error("Failed to update ticket:",x)}},fetchSavedTickets:async e=>{try{return await S(`/tickets/${e}`,"GET",void 0,!0)}catch{return[]}},generateUniqueTicketId:()=>`ticket-${Date.now()}-${Math.floor(Math.random()*1e3)}`,loading:d,error:s,success:c,generatedTickets:f,getTicketId:e=>e._id||`temp-${e.firstName}-${e.lastName}`,minBirthdate:"1900-01-01",minExpirationDate:e=>{const i=new Date(e.departureDate);return i.setMonth(i.getMonth()+3),i.toISOString().split("T")[0]},validateExpirationDate:(e,i,r,a)=>{const l=new Date(i[a(e)].expirationDate),u=new Date(e.departureDate);l<u?r[a(e)]={...r[a(e)],expirationDate:"Expiration date must be at least 3 months after departure"}:r[a(e)]={...r[a(e)],expirationDate:void 0}},validateBirthdate:(e,i,r,a)=>{new Date(i[a(e)].dateOfBirth)>new Date?r[a(e)]={...r[a(e)],dateOfBirth:"Birthdate cannot be a future date"}:r[a(e)]={...r[a(e)],dateOfBirth:void 0}}}},q={class:"w-full sm:w-[48%] font-sans text-gray-200 bg-zinc-800 p-5 border border-[#ff7f50] rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.3)]"},L={class:"flex justify-between items-center border-b-2 border-[#ff7f50] pb-4 pt-2"},j={class:"text-right flex gap-6"},F={class:"text-base"},G={class:"text-base"},P={class:"flex justify-between items-center mt-5 pt-4"},R={class:"text-center w-[35%]"},Y={class:"text-base"},V={class:"text-4xl font-bold text-[#ff7f50]"},z={class:"text-center w-[35%]"},H={class:"text-base"},J={class:"text-4xl font-bold text-[#ff7f50]"},Q={class:"mt-5 py-5"},Z={class:"text-2xl font-bold"},K={class:"flex justify-between gap-4 py-4 text-sm"},W={class:"text-right"},X={class:"font-bold"},tt={class:"text-center mt-6 mb-4"},et={class:"bg-white inline-block p-5 w-[45%] rounded-lg shadow-[0_4px_10px_rgba(0,0,0,0.3)]"},at=["src"],st={class:"text-xs text-gray-400 mt-2 text-center"},dt=O({__name:"TicketDisplay",props:{ticket:{type:Object,required:!0}},setup(n){const v=d=>new Date(d).toLocaleDateString(),h=d=>new Date(d).toLocaleString();return(d,s)=>{var c,f,p,D,b,A,k,w,N,T,g,y,e;return U(),E("div",q,[t("div",L,[s[2]||(s[2]=t("h1",{class:"text-2xl font-bold text-[#ff7f50]"},"FLYEAZY",-1)),t("div",j,[t("div",null,[s[0]||(s[0]=t("div",{class:"text-sm text-[#ff7f50]"},"DATE",-1)),t("div",F,o(v((c=n.ticket)==null?void 0:c.departureDate)||"N/A"),1)]),t("div",null,[s[1]||(s[1]=t("div",{class:"text-sm text-[#ff7f50]"},"FLY OUT",-1)),t("div",G,o(((f=n.ticket)==null?void 0:f.departureTime)||"N/A"),1)])])]),t("div",P,[t("div",R,[t("div",Y,o((p=n.ticket)==null?void 0:p.departureAirportName),1),t("div",V,o((D=n.ticket)==null?void 0:D.departureIATA),1)]),s[3]||(s[3]=t("div",{class:"text-3xl"},"âœˆ",-1)),t("div",z,[t("div",H,o((b=n.ticket)==null?void 0:b.arrivalAirportName),1),t("div",J,o((A=n.ticket)==null?void 0:A.arrivalIATA),1)])]),t("div",Q,[s[7]||(s[7]=t("div",{class:"text-xl text-[#ff7f50] font-normal"},"PASSENGER",-1)),t("div",Z,o((k=n.ticket)==null?void 0:k.firstName)+" "+o((w=n.ticket)==null?void 0:w.lastName),1),t("div",K,[t("div",null,[s[4]||(s[4]=t("div",{class:"text-[#ff7f50]"},"FLIGHT #",-1)),t("div",null,o(((N=n.ticket)==null?void 0:N.flightNumber)||"N/A"),1)]),t("div",null,[s[5]||(s[5]=t("div",{class:"text-[#ff7f50]"},"SEAT",-1)),t("div",null,o(((T=n.ticket)==null?void 0:T.seatNumber)||"N/A"),1)]),t("div",W,[s[6]||(s[6]=t("div",{class:"text-[#ff7f50]"},"STATUS",-1)),t("div",X,o(((g=n.ticket)==null?void 0:g.flightStatus)||"N/A"),1)])])]),t("div",tt,[t("div",et,[(y=n.ticket)!=null&&y.qrDataUrl?(U(),E("img",{key:0,src:n.ticket.qrDataUrl,alt:"QR Code",class:"w-full h-auto mx-auto"},null,8,at)):$("",!0)])]),t("div",st," Checked in at: "+o(h((e=n.ticket)==null?void 0:e.checkInTime)||"N/A"),1)])}}});export{dt as _,ot as u};
